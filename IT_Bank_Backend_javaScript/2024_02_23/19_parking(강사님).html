<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <style>
        #root {
            max-width: 1400px;
            margin: auto;
        }

        .item {
            display: flex;
        }

        .item>div {
            border: 1px solid black;
            flex: 1;
            padding: 5px 10px;
            text-align: center;
        }

        .item>div:nth-child(2) {

            flex: 2;

        }

        .columns {
            width: 1400px;
            margin: auto;
            background-color: #eee;
            position: sticky;
            top: 0;
        }

        .sort {
            width: 1400px;
            margin: auto;
            padding: 10px;
        }
    </style>
</head>

<body>
    <h1>ë¶€ì‚°ê´‘ì—­ì‹œ ì£¼ì°¨ì¥ ìš”ê¸ˆ í˜„í™©</h1>
    <hr>



    <div id="root">
        <div class="columns item">
            <div order = "1" class="pkNum"><span class="text">ì£¼ì°¨ì¥ ì´ë¦„</span><span class="arrow"></span></div>
            <div order = "1" class="guNm"><span class="text">ì§€ì—­</span><span class="arrow"></span></div>
            <div order = "1" class="pkFm"><span class="text">í˜•ì‹</span><span class="arrow"></span></div>
            <div order = "1" class="tenMin"><span class="text">10ë¶„ ì£¼ì°¨ ìš”ê¸ˆ</span><span class="arrow"></span></div>
            <div order = "1" class="ftDay"><span class="text">ì¼ ì£¼ì°¨ ê¸ˆì•¡</span><span class="arrow"></span></div>
            <div order = "1" class="ftMon"><span class="text">ì›” ì£¼ì°¨ ê¸ˆì•¡</span><span class="arrow"></span></div>
            <div order = "1" class="pkCnt"><span class="text">ì „ì²´ ì£¼ì°¨ ëŒ€ìˆ˜</span><span class="arrow"></span></div>
        </div>
        <div class="main"></div>
    </div>
    
    
    
    <script src="parking.js"></script>
    <script>

        const arr2 = arr.slice(0, 300)

        const main = document.querySelector('.main')
        
        arr2.forEach(dto => {
        /**********************************/
        // JSON ë°ì´í„° í™”ë©´ì— ë„ìš°ê¸°
            let tag = ''
            tag += `<div class="item">`
            tag += `     <div class="guNm">${dto.guNm}</div>`
            tag += `     <div class="pkNam">${dto.pkNam}</div>`
            tag += `     <div class="pkFm">${dto.pkFm}</div>`
            tag += `     <div class="pkCnt">${dto.pkCnt == "-" ? 0 : dto.pkCnt}</div>`
            tag += `     <div class="tenMin">${dto.tenMin == "-" ? 0 : dto.tenMin}</div>`
            tag += `     <div class="ftDay">${dto.ftDay == "-" ? 0 : dto.ftDay}</div>`
            tag += `     <div class="ftMon">${dto.ftMon == "-" ? 0 : dto.ftMon}</div>`
            tag += `</div>`
            main.innerHTML += tag
        });
        //JSON ë°ì´í„° í™”ë©´ì— ë„ìš°ê¸°
        //============================================

        /*í´ë¦­ ì´ë²¤íŠ¸ ì„¤ì • (ì •ë ¬)*/
        const columns = Array.from(document.querySelectorAll('div.columns > div'))

        // ì •ë ¬ í•¨ìˆ˜
        function sortHandler(event) {

            // ë‚´ê°€ í´ë¦­í•œ ëŒ€ìƒ(div)ì€ columnsì—ì„œ ëª‡ë³€ì§¸ ì¸ë±ìŠ¤ë¥¼ ê°€ì§€ëŠ”ê°€
            let target = event.target
            while(target.tagName != 'DIV'){
                target = target.parentNode
            }
            const idx = columns.indexOf(target) 
           
            const order = +target.getAttribute('order')
            target.setAttribute('order', -order) // -orderëŠ” -1(ë‹¤ìŒì—ëŠ” -1ì´ ë¶ˆëŸ¬ì™€ì§(ë¶€í˜¸ë°˜ì „))
            document.querySelectorAll('span.arrow').forEach(e => e.innerText ='')  // ëª¨ë“  í™”ì‚´í‘œ ì§€ì •
            target.querySelector('span.arrow').innerText = order > 0  ? 'ğŸ”»':'ğŸ”º'


            console.log(idx) // -1ì´ ë‚˜ì˜¤ë©´ ëŒ€ìƒì„ ì°¾ì§€ ëª»í–ˆë‹¤.
            console.log(order)

            const arr3 = Array.from(document.querySelectorAll('div.main > div.item'))

            arr3.sort((e1, e2) => {
                const e3 = +e1.children[idx].innerText // ê° ì •ë ¬ ëŒ€ìƒì˜ idxë²ˆì§¸ì˜ ê°’ìœ¼ë¡œ ë¹„êµ
                const e4 = +e2.children[idx].innerText
                return (e3 >= e4 ? 1 : -1) * order      // ë¶€ë“±í˜¸ ë°©í–¥ ë³€ê²½ìœ¼ë¡œ ì˜¤ë¦„ì°¨ìˆœ ë‚´ë¦¼ì°¨ìˆœ ë³€ê²½ ê°€ëŠ¥
            })
            arr3.forEach(e => main.appendChild(e))
        }

        columns.slice(3, 7).forEach(e => e.onclick = sortHandler) // 3ë¶€í„° 7 ì¸ë±ìŠ¤ ê¹Œì§€ë§Œ í´ë¦­ ì´ë²¤íŠ¸ ì ìš© 
        // ì£¼ì°¨ì¥ ì´ë¦„ ì§€ì—­ í˜•ì‹ ì„ í´ë¦­í•˜ë©´ í•¨ìˆ˜ ì‘ë™ ì•ˆí•¨.
    </script>
</body>

</html>